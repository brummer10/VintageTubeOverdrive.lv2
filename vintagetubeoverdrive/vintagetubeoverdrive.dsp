

/*******************************************************************************
**************************** File generated by *********************************
********************************************************************************
 ./build-plug.py -i VintageTubeDriver_p1.sch VintageTubeDriver_p2.sch VintageTubeDriver_p3.sch -t 2 -b -n VintageTubeOverdrive
*******************************************************************************/

// generated automatically
// DO NOT MODIFY!
declare id "vintagetubeoverdrive";
declare name "VintageTubeOverdrive";
declare category "Extern";
declare shortname "VintageTubeOverdrive";
declare description "VintageTubeOverdrive";

import("stdfaust.lib");


/*******************************************************************************
  * vintagetubedriver_p1 generated by dkbuiler from VintageTubeDriver_p1.sch
*******************************************************************************/

p1 = pre : fi.iir((b0/a0,b1/a0,b2/a0,b3/a0,b4/a0),(a1/a0,a2/a0,a3/a0,a4/a0)) with {
    LogPot(a, x) = ba.if(a, (exp(a * x) - 1) / (exp(a) - 1), x);
    Inverted(b, x) = ba.if(b, 1 - x, x);
    s = 0.993;
    fs = float(ma.SR);
    pre = _;


    Drive = vslider("Drive[name:Drive][style:knob]", 0.5, 0, 1, 0.01) : Inverted(0) : LogPot(5) : si.smooth(s);

    b0 = -8.99291504835734e-13*Drive*pow(fs,3);

    b1 = 1.79858300967147e-12*Drive*pow(fs,3);

    b2 = 0;

    b3 = -1.79858300967147e-12*Drive*pow(fs,3);

    b4 = 8.99291504835734e-13*Drive*pow(fs,3);

    a0 = Drive*(fs*(fs*(fs*(2.47143558158841e-19*fs + 1.26789641493622e-15) + 1.04220801979972e-13) + 9.59649199889129e-13) + 2.3917927064341e-14) + fs*(fs*(2.47143558158842e-15*fs + 2.0781652178362e-13) + 1.91927683637056e-12) + 4.7835854128682e-14;

    a1 = Drive*(fs*(pow(fs,2)*(-9.88574232635365e-19*fs - 2.53579282987245e-15) + 1.91929839977826e-12) + 9.5671708257364e-14) + fs*(-4.94287116317683e-15*pow(fs,2) + 3.83855367274112e-12) + 1.91343416514728e-13;

    a2 = Drive*(pow(fs,2)*(1.48286134895305e-18*pow(fs,2) - 2.08441603959944e-13) + 1.43507562386046e-13) - 4.1563304356724e-13*pow(fs,2) + 2.87015124772092e-13;

    a3 = Drive*(fs*(pow(fs,2)*(-9.88574232635365e-19*fs + 2.53579282987245e-15) - 1.91929839977826e-12) + 9.5671708257364e-14) + fs*(4.94287116317683e-15*pow(fs,2) - 3.83855367274112e-12) + 1.91343416514728e-13;

    a4 = Drive*(fs*(fs*(fs*(2.47143558158841e-19*fs - 1.26789641493622e-15) + 1.04220801979972e-13) - 9.59649199889129e-13) + 2.3917927064341e-14) + fs*(fs*(-2.47143558158842e-15*fs + 2.0781652178362e-13) - 1.91927683637056e-12) + 4.7835854128682e-14;
};

/*******************************************************************************
  * vintagetubedriver_p2 generated by dkbuiler from VintageTubeDriver_p2.sch
*******************************************************************************/

p2 = pre : fi.iir((b0/a0,b1/a0,b2/a0,b3/a0),(a1/a0,a2/a0,a3/a0)) : vintagetubedriver_p2_clip with {
    LogPot(a, x) = ba.if(a, (exp(a * x) - 1) / (exp(a) - 1), x);
    Inverted(b, x) = ba.if(b, 1 - x, x);
    s = 0.993;
    fs = float(ma.SR);
    pre = _;



    Tone = vslider("Tone[name:Tone][style:knob]", 0.5, 0, 1, 0.01) : Inverted(0) : si.smooth(s);

    b0 = 1.51032483421641e-14*Tone*pow(fs,3) + 1.60672854703873e-11*pow(fs,2);

    b1 = -4.53097450264922e-14*Tone*pow(fs,3) - 1.60672854703873e-11*pow(fs,2);

    b2 = 4.53097450264922e-14*Tone*pow(fs,3) - 1.60672854703873e-11*pow(fs,2);

    b3 = -1.51032483421641e-14*Tone*pow(fs,3) + 1.60672854703873e-11*pow(fs,2);

    a0 = fs*(fs*(8.70253913610682e-15*fs + 1.61386401890662e-11) + 8.01348882317983e-9) + 7.17400553341744e-7;

    a1 = fs*(fs*(-2.61076174083205e-14*fs - 1.61386401890662e-11) + 8.01348882317983e-9) + 2.15220166002523e-6;

    a2 = fs*(fs*(2.61076174083205e-14*fs - 1.61386401890662e-11) - 8.01348882317983e-9) + 2.15220166002523e-6;

    a3 = fs*(fs*(-8.70253913610682e-15*fs + 1.61386401890662e-11) - 8.01348882317983e-9) + 7.17400553341744e-7;
};

    vintagetubedriver_p2_clip = ffunction(float vintagetubedriver_p2clip(float), "vintagetubedriver_p2_table.h", "");


/*******************************************************************************
  * vintagetubedriver_p3 generated by dkbuiler from VintageTubeDriver_p3.sch
*******************************************************************************/

p3 = pre : fi.iir((b0/a0,b1/a0),(a1/a0)) with {
    LogPot(a, x) = ba.if(a, (exp(a * x) - 1) / (exp(a) - 1), x);
    Inverted(b, x) = ba.if(b, 1 - x, x);
    s = 0.993;
    fs = float(ma.SR);
    pre = _;


    Volume = vslider("Volume[name:Volume][style:knob]", 0.5, 0, 1, 0.01) : Inverted(0) : LogPot(3) : si.smooth(s);

    b0 = 2.08330921921294e-5*Volume*fs;

    b1 = -2.08330921921294e-5*Volume*fs;

    a0 = 2.0833311631967e-5*fs + 1.04166558159835e-6;

    a1 = -2.0833311631967e-5*fs + 1.04166558159835e-6;
};

process =  p1 : *(2.0) : p2 : p3 : *(2.0);
